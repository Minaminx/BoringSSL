language: c

dist: trusty
sudo: required

# https://docs.travis-ci.com/user/languages/c/
matrix:
  include:
    # works on Trusty
    - os: linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-6
      env:
        - MATRIX_EVAL="CC=gcc-6 && CXX=g++-6"

before_install: 
  - eval "${MATRIX_EVAL}"
  - sudo apt-get update
  - sudo apt-get install -y build-essential cmake golang

script: 
  - sudo git clone --depth=1 --branch=master https://github.com/Minaminx/BoringSSL.git boringssl
  - sudo cd boringssl
  - sudo export CFLAGS="-Wno-error"
  - sudo mkdir build
  - sudo cd build
  - sudo cmake -DCMAKE_BUILD_TYPE=Release -DOPENSSL_SMALL=1 ../
  - sudo make
  - sudo cd ..
  - sudo mkdir -p .openssl/lib
  - sudo cd .openssl
  - sudo ln -s ../include .
  - sudo cd ..
  - sudo cp build/crypto/libcrypto.a build/ssl/libssl.a .openssl/lib
  - sudo cd ..
